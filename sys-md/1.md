Refactor the given code, organizing it into functions and ensuring that each function returns the necessary data for the subsequent functions. The code should be modular, with each function responsible for a specific task. Use meaningful function names and include any necessary docstrings. The main function should orchestrate the overall process, ensuring that each step is performed in sequence and that the necessary data is passed between functions.



